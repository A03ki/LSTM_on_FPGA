#include <stdio.h>
#include <stdlib.h>
#include "layer/affine.h"
#include "function/relu.h"
#include "layer/lstm.h"
// #include "layer/max.h"


// パラメーターの配列の長さの定義始まり
#define LSTM0_WEIGHT_IH_L0 20
#define LSTM0_WEIGHT_HH_L0 100
#define LSTM0_BIAS_L0 20
#define LINEAR0_WEIGHT 500
#define LINEAR0_BIAS 1
#define OUTPUT_LSTM0 500
#define OUTPUT_LINEAR0 1
// パラメーターの配列の長さの定義終わり

int main(void) {
        int i, j;

        // パラメーターのサイズの定義始まり
        int lstm0_row = 100;
        int lstm0_matrix_k = 1;
        int lstm0_column = 5;
        int linear0_row = 1;
        int linear0_matrix_k = 500;
        int linear0_column = 1;
        // パラメーターのサイズの定義終わり

        float input_x[100] = {0.7870594, 0.7957617, 0.69823444, 0.6508203, 0.5495051, 0.37597457, 0.2473222, 0.14875819, 0.15665999, -0.049335577, -0.023821928, -0.2065435, -0.3015138, -0.24987994, -0.48387522, -0.4429239, -0.6106722, -0.7352999, -0.6758182, -0.70198554, -0.794438, -0.92499727, -0.86822194, -0.82850766, -0.84487504, -0.8004133, -0.82008266, -0.874295, -0.7625296, -0.7309362, -0.80724245, -0.6204992, -0.6466767, -0.50536186, -0.49051213, -0.28973925, -0.3380574, -0.15829031, -0.1285131, 0.08477531, 0.079749994, 0.15865853, 0.22560933, 0.33355227, 0.57752043, 0.5691949, 0.7467413, 0.78798854, 0.8339698, 0.8101296, 0.9045058, 1.0614643, 1.1286478, 1.0750327, 1.0043513, 1.0623417, 1.0357231, 1.0906588, 0.9766535, 1.1331674, 1.0314078, 1.0410806, 0.88586533, 0.88394105, 0.8257387, 0.713848, 0.6546121, 0.46228725, 0.4757981, 0.24064244, 0.13714507, 0.15083003, 0.019658681, -0.04659406, -0.19328356, -0.3518054, -0.278961, -0.45410073, -0.5077377, -0.5695204, -0.69932026, -0.6731035, -0.71165985, -0.91247493, -0.9399071, -0.8922652, -0.9734842, -0.80946517, -0.8745081, -0.87142956, -0.9258926, -0.8368534, -0.75882584, -0.7322357, -0.6678139, -0.6723787, -0.57757926, -0.39801964, -0.2506454, -0.27472574};

        // 初期化の定義始まり
        float output_x1[OUTPUT_LSTM0] = {0.0};
        float output_x2[OUTPUT_LINEAR0] = {0.0};
        //　初期化の定義終わり

        // パラメーターの定義始まり
        float lstm0_weight_ih_l0[LSTM0_WEIGHT_IH_L0] = {0.168851808,-0.434012830,0.385257423,0.253687382,0.092700168,0.430407584,0.048924554,-0.287638873,0.269364983,0.140414953,0.156430468,0.301525056,0.451895982,-0.411199957,-0.294745803,-0.132373571,-0.282764345,0.121456064,-0.148585603,-0.286335588};
        float lstm0_weight_hh_l0[LSTM0_WEIGHT_HH_L0] = {-0.117248446,0.423365802,0.382195055,-0.383861572,-0.312899351,-0.229010686,-0.240590051,0.318118185,-0.104862139,0.124012999,-0.131207943,0.108109757,-0.188633263,0.023578415,-0.343635380,0.113666266,0.403061450,-0.216603115,0.147894904,-0.365914524,0.192734376,0.028048182,-0.323292434,0.424573839,0.175996542,0.280847907,0.209196821,0.186637312,-0.034084987,-0.083020568,-0.437410980,0.046317033,-0.391217858,-0.301536292,0.316129655,0.236362040,0.146158457,-0.427008331,-0.191916585,-0.155023411,-0.372509181,-0.337063968,-0.318263769,0.357132167,-0.295158625,0.004053207,0.250907987,0.099689141,-0.341779292,-0.003862515,0.229461029,0.098694921,-0.292386264,-0.268358678,0.283948988,-0.053975377,0.144064337,0.016702484,-0.234760553,-0.153066605,-0.151916862,-0.153669134,0.323892146,0.137171701,-0.157973215,-0.019867789,-0.413286537,-0.396156639,-0.155127987,-0.031691324,0.171012148,0.398039520,-0.243254602,0.096895106,-0.022253523,0.094699711,0.173595235,0.347093046,-0.070773840,0.088758804,-0.080768466,-0.221137062,0.285435230,-0.009574417,0.214175403,-0.029060030,0.023825400,0.130944133,-0.094639353,-0.194935963,0.176023737,-0.284108669,0.074552909,0.091134794,0.453584313,-0.384277135,0.050595496,-0.289552748,-0.418247014,-0.399193078};
        float lstm0_bias_l0[LSTM0_BIAS_L0] = {0.285219431,-0.059569780,0.046923310,0.298208803,0.398574024,-0.261193335,0.657509267,-0.109704748,-0.210470155,0.284697860,-0.119011544,0.178320199,0.244535178,-0.401969552,0.102944642,0.573798656,-0.379716992,0.613616526,-0.101805598,-0.008874118};
        float linear0_weight[LINEAR0_WEIGHT] = {0.004946346,-0.043646079,-0.011884483,-0.002624829,0.001607348,0.005807534,-0.044392165,-0.027436042,0.033331819,-0.010281167,-0.014396692,0.014128325,-0.086897656,-0.018088294,0.007350761,0.014925104,-0.048440579,-0.073397271,-0.037127037,0.014648224,-0.003713790,-0.009383958,-0.077084653,-0.034525838,0.041090682,0.014528844,-0.044092707,-0.037067980,-0.041526243,0.014617394,0.018973039,-0.052891359,-0.086000517,0.003547161,0.046765208,0.033819292,-0.033585101,-0.050728124,0.017214740,0.075361334,-0.015934521,-0.024248818,-0.046877999,-0.038877618,0.037554849,-0.007473039,-0.012538215,-0.099188089,0.018669592,0.031542327,-0.021271691,-0.048993412,-0.091716804,0.015759017,-0.000397713,0.021441642,0.000559528,-0.051028121,-0.034367327,0.055229239,0.017569700,-0.043285917,-0.042238262,-0.036620509,0.045173444,-0.017052984,-0.008580206,-0.039609052,0.009526177,0.074250802,-0.026522862,-0.035798363,-0.071658298,0.039780036,0.047169194,0.040762138,-0.005020645,-0.058440413,-0.035180666,0.007120933,-0.040226705,-0.051421452,-0.015889488,0.005730232,0.015993718,-0.000958666,-0.021994615,-0.036157947,-0.005144629,0.015259682,-0.000742810,0.013211646,-0.048467755,-0.038868904,-0.020267149,-0.026403965,-0.010273610,-0.013412566,-0.023842081,0.048949085,0.028187534,0.005519317,0.022824753,-0.015306253,0.013653905,0.020716397,-0.037667293,0.021178048,-0.018709287,0.026396189,0.023497464,-0.031206742,0.029893111,-0.023214240,0.012110861,0.012866476,0.015060750,0.019153468,-0.030807719,0.004719413,0.017566722,-0.038535260,0.025674900,-0.024978969,-0.009421592,0.022126798,0.005058563,0.029333869,0.028719187,-0.049884122,0.007904006,-0.014500909,0.025105346,-0.009140326,0.002109241,-0.040442925,-0.011926627,0.052122824,-0.000980043,-0.016071349,0.006048738,0.039398454,0.011435242,-0.039634693,-0.022864358,-0.005140172,0.026692174,0.049683221,0.005383095,-0.051127471,-0.023739407,0.042980429,0.051477041,-0.009860699,-0.041207276,-0.039499089,-0.008363855,0.073079072,-0.027543889,-0.044974294,0.001719493,0.041804295,0.063118525,-0.002110591,-0.051845893,-0.011181245,0.032062672,0.081644244,-0.015412956,0.011711895,0.026905892,-0.002035306,0.078766413,0.029629558,-0.025522001,0.020569108,-0.005409707,0.076032199,0.023733070,-0.074455380,0.035361141,0.002341333,0.027438572,0.030265849,0.006753923,0.013625670,0.038516950,0.052926108,-0.002527724,-0.059497703,-0.024498738,-0.004237583,0.064284213,0.001982476,-0.045655780,0.042099256,0.047979310,0.059183393,0.015635461,-0.011422279,0.034562699,0.067604125,0.063198656,0.013278099,-0.001842648,-0.042135149,0.032702923,0.066694058,0.021898132,-0.072282672,0.004946993,0.042515796,0.099929437,0.000922147,-0.028709972,0.021336351,0.025060838,0.085876592,0.036038708,-0.062434763,-0.028955046,0.053997744,0.018168073,0.019719444,-0.031799190,0.013176108,0.066535272,0.048672963,0.007004500,-0.072110415,0.043805126,0.039228413,0.009892830,-0.038483273,0.014013622,0.008366090,0.062057488,0.006529976,0.022925960,-0.009936673,0.014980172,0.039383892,0.025142893,0.003121021,-0.059332497,0.042833593,-0.019719595,0.054638006,0.002629911,-0.018358167,-0.015097803,0.009173424,0.013267539,-0.023958830,-0.017501680,0.021081116,0.053286832,0.035644080,-0.018123988,0.019102005,-0.014623542,0.030889863,-0.011236467,0.019232200,-0.040956821,-0.025556948,0.010593118,-0.005742341,-0.030037005,0.032897148,0.021995930,0.022431478,-0.047309399,0.014818128,-0.011466444,0.043154512,0.025999829,0.011508621,0.033026744,-0.001719784,0.013594098,-0.013501699,-0.039132524,-0.013148407,-0.032922212,0.028051628,-0.030499052,-0.047988147,-0.040118594,0.010240123,-0.001326730,-0.037248515,-0.050615590,0.010553313,0.018285656,-0.004441398,0.016090414,-0.042688083,0.036832765,0.035187598,-0.021121806,0.000986243,-0.079792127,0.016999396,-0.000815981,-0.016343568,0.015918456,-0.017519688,0.032241005,0.005234235,0.033800010,0.006489653,-0.088885255,0.030098377,0.046313375,-0.001516538,-0.046379492,-0.010749001,0.042305112,0.045821849,0.031994015,0.009873320,-0.010977606,0.022486726,0.024597181,0.042510211,-0.061558224,-0.045441750,0.026638824,0.010849638,-0.039849751,-0.062331572,-0.056006767,0.014718289,0.039667439,-0.006226731,-0.033891182,-0.093469493,0.006401487,0.003249306,0.020699881,-0.025263937,-0.019582456,0.029054984,0.065365501,0.039285462,0.007304819,-0.021045838,0.013987578,0.015327336,-0.033277582,0.009813171,-0.101736896,-0.036485061,0.056601826,0.034685612,-0.035824630,-0.069928795,0.036149498,0.055727564,-0.045417342,0.009805650,-0.077493370,-0.014717843,0.036218777,0.025884250,-0.000713140,-0.060864545,0.033681694,0.010322504,-0.026859893,-0.025283929,-0.062477417,0.005032175,0.031763844,-0.026118888,-0.000154012,-0.048096094,0.034136634,0.026932856,-0.036279447,-0.055867381,-0.058945496,0.001187442,0.054480318,-0.018018799,-0.017231092,-0.013370189,0.002340602,0.021233177,-0.037087061,-0.045278285,-0.022987349,-0.017173804,0.017615713,0.013145433,-0.002942203,-0.002222380,0.016231447,-0.021569384,0.034092546,-0.043161243,-0.015031572,0.017952237,0.037352432,0.019680034,-0.043966588,-0.005335697,0.040925380,0.020307776,-0.043253519,-0.039302282,0.010721288,0.014943291,0.008365209,-0.037250329,-0.012588376,-0.052187659,-0.025133073,0.042277724,-0.024517279,-0.012654427,-0.001994492,-0.039366227,0.032328501,-0.027619235,-0.047980856,-0.035392515,-0.016256534,0.014651623,-0.030250406,0.002372775,0.018283900,0.037625752,0.014252961,-0.011295866,-0.009698909,-0.009327125,0.005565140,0.029328916,0.006130013,0.027665509,0.021027399,-0.008310085,-0.003119528,-0.003894415,-0.026860652,0.052274086,-0.029566096,-0.028834406,-0.025312921,0.027383992,0.058675464,-0.039363880,-0.044912554,0.005565479,-0.029021127,0.037188534,0.023259027,0.003360103,-0.002893429,0.032146122,0.082695007,-0.014506747,0.003949375,0.036270849,-0.012554296,0.007138358,-0.004223261,-0.024071695,-0.025742106,0.018588334,0.012821953,-0.002426333,-0.047413912,-0.015836939,-0.012717174,0.006766174,0.002486398,-0.045532539,-0.032173432,0.053076021,0.053446971,0.033400871,0.006923368,-0.016768852,0.020236369,0.063194789,0.008553312,-0.046405584,-0.034937058,0.054931384,0.082671002,0.030038241,-0.013226530,0.035560809,-0.015827617,0.096667320,0.011285614,-0.027589729};
        float linear0_bias[LINEAR0_BIAS] = {0.037095811};
        // パラメーターの定義終わり

        for (i = 0; i < 100; i++) {
                lstm(output_x1, input_x, lstm0_weight_ih_l0, lstm0_weight_hh_l0,
                     lstm0_bias_l0, lstm0_row, lstm0_matrix_k, lstm0_column);
                relu(output_x1, OUTPUT_LSTM0);
                affine(output_x2, output_x1, linear0_weight, linear0_bias,
                       linear0_row, linear0_matrix_k, linear0_column);
                for (j = 0; j < 99; j++) {
                        input_x[j] = input_x[j + 1];
                }
                input_x[99] = output_x2[0];
        }

        // 確認用
        for (i = 0; i < 100; i++) {
                printf("%f\n", input_x[i]);
        }

        return 0;
}
