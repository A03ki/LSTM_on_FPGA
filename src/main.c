#include <stdio.h>
#include <stdlib.h>
// #include "layer/affine.h"
#include "layer/lstm.h"
// #include "layer/max.h"

int main(void) {
        int row, matrix_k, column, t;
        row = 4, matrix_k = 3, column = 3;
        float input_x[4 * 3] = {0.0, 1.0, 2.0, 1.0, 2.0, 3.0, 2.0, 3.0, 4.0, 3.0, 4.0, 5.0};
        // 初期化
        float output_x[4 * 3] = {0.0};

        //重み定義
        float weight_fgio_x[3 * 4 * 3] = {0.29748732,  0.27099025, -0.11877558, -0.07069314,  0.2108646,
                                          -0.05197728,  0.5047004, -0.34869725, -0.18501103,  0.313811,
                                          0.16129082, -0.52604556, -0.25482982, -0.5435388,  0.2937234,
                                          0.16013438, -0.22499397,  0.08368343,  0.17966568, -0.09677294,
                                          0.02764446, -0.5643892,  0.5476488, -0.5489495, -0.11192599,
                                          0.3462469,  0.08026147,  0.02848172, -0.04209387, -0.0023064,
                                          -0.21500885, -0.24903467,  0.3441745,  0.35791123,  0.3810857,
                                          -0.27847457};
        float weight_fgio_h[3 * 4 * 3] = {0.50697803, -0.26830125,  0.4329692,  0.29676658, -0.16671404,
                                          -0.27527004,  0.5750694, -0.38537154, -0.3732106,  0.5120491,
                                          -0.01118433, -0.40970066, -0.09616864,  0.5665065,  0.00683677,
                                          -0.30646914, -0.06329745,  0.31328988,  0.46279728,  0.3515845,
                                          0.37501472, -0.32363924,  0.08432633,  0.3140812,  0.24708247,
                                          -0.24427599, -0.30415818,  0.16980141, -0.55505764, -0.14034072,
                                          -0.02703363,  0.17918473,  0.35051036, -0.09503531, -0.43816167,
                                          -0.135384};

        //バイアス定義
        float bias_fgio[4 * 3] = {0.6211119, -0.30144942, -0.32368398,  0.5471303,  0.12431368,
                                  0.61093354, -0.3490818, -0.14233065, -0.2899597, -0.29693842,
                                  -0.35145867, -0.3723213};

        lstm(output_x, input_x, weight_fgio_x, weight_fgio_h, bias_fgio, row, matrix_k, column); // 重みは3×3

        // 確認用
        for (t = 0; t < row * column; t++) {
                printf("%f\n", output_x[t]);
        }

        return 0;
}
